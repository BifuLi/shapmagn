{
    "dataset": {
        "name": "pair_dataset",
        "pair_dataset": {
            "reader" : "toy_dataset_utils.toy_reader()",
                "sampler" : "toy_dataset_utils.toy_sampler()",
            "normalizer": "toy_dataset_utils.toy_normalizer()",
            "max_num_for_loading": [-1,-1,-1,-1],
            "load_training_data_into_memory": true,
            "aug_data_via_inverse_reg_direction": false
        }
    },
    "tsk_set": {
        "batch_sz": [2,1,1,1],
        "gpu_ids": 0,
        "max_batch_num_per_epoch": [
                800,
                600,
                50
            ],
        "model": "optimization",
        "method_name": "gradient_flow_opt",
        "loss_name": "geomloss",
        "create_shape_pair_from_data_dict": "shape_pair_utils.create_source_and_target_shape()",
        "gradient_flow_opt": {
            "print_step":10,
            "interpolator_obj": "point_interpolator.nadwat_kernel_interpolator(scale=0.1, exp_order=2)",
            "sim_loss": {
                "loss_list": ["geomloss"],
                "loss_weight_strategy_dict":{},
                "loss_activate_epoch_list": [0],
                "geomloss":{
                    "attr": "points",
                    "geom_obj": "geomloss.SamplesLoss(loss='sinkhorn',blur=0.005, scaling=0.8, reach=0.1,debias=True)"
                },
                "l2": {
                    "attr": "points"
                },
                "varifold": {
                    "kernel_backend": "keops",
                    "sigma": 0.1

                },
                "current": {
                    "kernel_backend": "keops",
                    "sigma": 0.1
                }
            }
        },
        "multi_scale_optimization": {
            "point_grid_scales": [ -1],
            "iter_per_scale": [3],
            "rel_ftol_per_scale": [1e-4,1e-4, 1e-4],
            "save_3d_shape_every_n_iter": 20,
            "shape_sampler_type": "point_grid",
            "stragtegy" : "use_optimizer_defined_from_model"
        },
        "save_fig_on": true,
        "is_train": false
    }
}