{
    "dataset": {
        "name": "pair_dataset",
        "pair_dataset": {
            "reader" : "lung_dataset_utils.lung_reader()",
            "sampler" : "lung_dataset_utils.lung_sampler(num_sample=1000, method='uniform')",
            "normalizer": "lung_dataset_utils.lung_normalizer()",
            "max_num_for_loading": [-1,-1,-1,-1],
            "load_training_data_into_memory": true,
            "aug_data_via_inverse_reg_direction": false
        }
    },
    "tsk_set": {
        "batch_sz": [2,1,1,1],
        "eval_phase_inner_loop_bch_sz": 20,
        "check_best_model_period": 5,
        "continue_train": false,
        "continue_train_lr": 5e-04,
        "criticUpdates": 2,
        "epoch": 400,
        "gpu_ids": 0,
        "max_batch_num_per_epoch": [
                800,
                600,
                50
            ],
        "model": "optimization",
        "model_path": "",
        "n_in_channel": 1,
        "method_name": "lddmm_opt",
        "loss_name": "geomloss",
        "lddmm_opt": {
            
        },
        "optim": {
            "adam": {
                "beta": 0.9
            },
            "lr": 0.0005,
            "lr_scheduler": {
                "custom": {
                    "gamma": 0.5,
                    "step_size": 60
                },
                "type": "custom"
            },
            "optim_type": "adam"
        },
        "output_taking_original_image_format": false,
        "print_step": [
            10,
            10,
            10
        ],
        "print_val_detail": true,
        "texture_efficient_net": {
            "input_channel": 3,
            "encoder_path": "/playpen-raid1/zyshen/videocue/dfdc_wining/weights/final_999_DeepFakeClassifier_tf_efficientnet_b7_ns_0_23",
            "pretrained_model_path": "",
            "encoder": "tf_efficientnet_b7_ns",
            "operator_on_fea_layer": "mean",
            "operator_on_fc_layer": ""
        },
        "temporal_pwc_net": {
            "input_channel": 3,
            "encoder_path": "",
            "fix_encoder": true,
            "pretrained_model_path": "",
            "operator_on_fea_layer": "max",
            "operator_on_fc_layer": ""
        },
        "weight_temporal_net": {
            "weight_net_backbone_type": "texture_efficient_extractor",
            "weight_sum_reg_factor": 1,
            "decay_factor": 5,
            "texture_efficient_extractor": {
              "input_channel": 9,
              "extractor": "tf_efficientnet_b2_ns"
          }
        },
        "ensemble_net": {
            "model_list": ["texture_efficient_net","temporal_pwc_net"],
            "loss_list": ["ce","ce"],
            "weight_net_type": "weight_temporal_net",
            "activate_train_model_epoch": [50,50]
        },

        "save_fig_on": true,
        "is_train": false,
        "val_period": 10,
        "warmming_up_epoch": 2
    }
}