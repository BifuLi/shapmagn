{
    "dataset": {
        "name": "pair_dataset",
        "pair_dataset": {
            "reader" : "lung_dataloader_utils.lung_reader()",
            "sampler" : "lung_dataloader_utils.lung_sampler( method='combined',scale=0.001,num_sample=30000)",
            "normalizer": "lung_dataloader_utils.lung_normalizer(weight_scale=60000)",
            "pair_postprocess_obj": "lung_dataloader_utils.lung_pair_postprocess()",
            "max_num_for_loading": [-1,-1,-1,-1],
            "load_training_data_into_memory": false,
            "aug_data_via_inverse_reg_direction": false
        }
    },
    "tsk_set": {
        "batch_sz": [
            2,
            1,
            1,
            1
        ],
        "epoch": 100,
        "gpu_ids": 0,
        "max_batch_num_per_epoch": [
            800,
            600,
            50
        ],
        "model": "deep_learning",
        "method_name": "feature_deep",
        "loss_name": "geomloss",
        "prepare_input_object": "lung_shape_pair.prepare_synth_input()",
        "source_target_generator": "shape_pair_utils.create_source_and_target_shape()",
        "feature_deep": {
            "debugging_visualize": false,
            "deep_extractor": "pointnet2_extractor",
            "pointnet2_extractor": {
                "local_pair_feature_extractor_obj": "lung_feature_extractor.LungFeatureExtractor(fea_type_list=['cov','weights'],weight_list=[1.0,'1000.'], radius=0.06,std_normalize=True, include_pos=False, fixed=True)",
                "include_position": true
            },
            "deepfea_loss": {
                "loss_type": "ot_corres",
                "geomloss": {
                    "attr": "pointfea",
                    "geom_obj": "geomloss.SamplesLoss(loss='sinkhorn',blur=blurplaceholder, scaling=0.8,reach=reachplaceholder,debias=False)"
                }
            },
            "interp_kernel_obj": "point_interpolator.nadwat_kernel_interpolator(exp_order=2)",
            "print_step": 1,
            "saving_debugging_visualize": true,
            "sim_loss_for_evaluation_only": {
                "geomloss": {
                    "attr": "points",
                    "geom_obj": "geomloss.SamplesLoss(loss='sinkhorn',blur=0.001, scaling=0.8,reach=1.0, debias=False)"
                },
                "loss_activate_epoch_list": [
                    0
                ],
                "loss_list": [
                    "geomloss"
                ],
                "loss_weight_strategy": ""
            },
            "spline_kernel_obj": "point_interpolator.NadWatAnisoSpline(exp_order=2,cov_sigma_scale=0.02,aniso_kernel_scale=0.12,principle_weight=(3.,1.,1.),eigenvalue_min=0.1,iter_twice=True)"
        },
        "optim": {
            "type": "adam",
            "lr": 0.001,
            "adam": {
                "betas": [
                    0.9,
                    0.999
                ]
            }
        },
        "scheduler": {
            "type": "step_lr",
            "step_lr": {
                "gamma": 0.5,
                "step_size": 50
            }
        },
        "save_fig_on": true,
        "is_train": true
    }
}