{
    "dataset": {
        "name": "pair_dataset",
        "pair_dataset": {
            "reader" : "lung_dataloader_utils.lung_reader()",
            "sampler" : "lung_dataloader_utils.lung_sampler( method='combined',scale=-1,num_sample=-1,sampled_by_weight=True)",
            "normalizer": "lung_dataloader_utils.lung_normalizer(weight_scale=1,scale=[1,1,1])",
            "pair_postprocess_obj": "",
            "max_num_for_loading": [1,1,1,1],
            "enlarge_dataset_size_by_factor": 100,
            "load_training_data_into_memory": false,
            "aug_data_via_inverse_reg_direction": false
        }
    },
    "tsk_set": {
        "batch_sz": [
            1,
            1,
            1,
            1
        ],
        "epoch": 300,
        "gpu_ids": 0,
        "max_batch_num_per_epoch": [
            100,
            1,
            1
        ],
        "model": "deep_learning",
        "method_name": "feature_deep",
        "prepare_input_object": "hybird_data.HybirdData(synthsizer_obj='lung_data_aug.lung_synth_data(do_rigid_aug=False)', raw_source_target_has_corr=True,corr_sampled_source_target=False, synth_ratio=0.0, ratio_decay_rate=-1, min_synth_ratio=0.0,npoints=-1)",
        "capture_plot_obj": "visualizer.capture_plotter(render_by_weight=True,add_bg_contrast=False,camera_pos=[(-4.924379645467042, 2.17374925796456, 1.5003730890759344),(0.0, 0.0, 0.0),(0.40133888001174545, 0.31574165540339943, 0.8597873634998591)])",
        "val_period": 5,
        "feature_deep": {
            "deep_extractor": "pointconv_extractor",
            "pointconv_extractor": {
                "local_pair_feature_extractor_obj": "lung_feature_extractor.get_naive_lung_feature(include_xyz=False, weight_factor=1000)",
                "input_channel": 1,
                "output_channel": 6,
                "param_shrink_factor": 1,
                "initial_npoints": 4096,
                "initial_radius": 0.001,
                "include_pos_in_final_feature": false,
                "use_aniso_kernel": true
            },
            "deepfea_loss": {
                "loss_type": "ot_map",
                "geomloss": {
                    "attr": "pointfea",
                    "geom_obj": "geomloss.SamplesLoss(loss='sinkhorn',blur=0.001, scaling=0.8,reach=None,debias=False, backend='online')",
                    "mode": "soft"
                }
            },
            "sim_factor": 10.0,
            "reg_factor_init": 1,
            "reg_factor_decay": 6,
            "static_epoch": 5,
            "spline_kernel_obj": "point_interpolator.NadWatIsoSpline(exp_order=2,kernel_scale=0.05)",
            "interp_kernel_obj": "point_interpolator.NadWatIsoSpline(exp_order=2,kernel_scale=0.005)",
            "print_step": 10,
            "saving_running_result_visualize": true,
            "geom_loss_opt_for_eval": {
                "attr": "points",
                "geom_obj": "geomloss.SamplesLoss(loss='sinkhorn',blur=0.001, scaling=0.8,reach=None, debias=False, backend='online')"
            }
        },
        "optim": {
            "type": "adam",
            "lr": 5e-5,
            "adam": {
                "betas": [
                    0.9,
                    0.999
                ]
            }
        },
        "scheduler": {
            "type": "step_lr",
            "step_lr": {
                "gamma": 0.1,
                "step_size": 10
            }
        },
        "save_fig_on": true,
        "is_train": true,
        "reset_train_epoch": false,
        "load_model_but_train_from_epoch": 0,
        "continue_train": false,
        "continue_train_lr": 1e-7,
        "model_path":""
    }
}